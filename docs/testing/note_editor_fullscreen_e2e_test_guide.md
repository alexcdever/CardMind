# 全屏笔记编辑器 - 手动端到端测试指南

## 测试目标
验证全屏笔记编辑器在实际使用场景中的功能完整性和用户体验。

## 测试环境
- **设备**: iOS/Android 真机或模拟器
- **Flutter 版本**: 3.38.5-stable
- **测试时间**: 约 15-20 分钟

## 测试场景

### 1. 新建笔记流程

#### 1.1 打开编辑器
- [ ] 从主屏幕点击"新建笔记"按钮
- [ ] 验证编辑器从底部滑入动画流畅（300ms）
- [ ] 验证工具栏正确显示（关闭按钮、自动保存文字、完成按钮）
- [ ] 验证标题和内容输入框正确显示占位符文本

#### 1.2 输入内容
- [ ] 在标题输入框输入"测试笔记标题"
- [ ] 验证输入响应流畅，无明显延迟
- [ ] 在内容输入框输入多行文本（至少 5 行）
- [ ] 验证内容输入框自动扩展高度
- [ ] 验证软键盘弹出时界面正确调整

#### 1.3 自动保存
- [ ] 输入内容后等待 1 秒
- [ ] 验证自动保存触发（可通过日志或数据库查看）
- [ ] 快速连续输入多次
- [ ] 验证自动保存有防抖机制（不会频繁保存）

#### 1.4 完成保存
- [ ] 点击"完成"按钮
- [ ] 验证笔记保存成功
- [ ] 验证编辑器关闭动画流畅
- [ ] 验证返回主屏幕后笔记显示在列表中

### 2. 编辑现有笔记流程

#### 2.1 打开编辑器
- [ ] 从笔记列表点击一张笔记
- [ ] 验证编辑器打开并显示笔记内容
- [ ] 验证标题和内容正确加载
- [ ] 验证元数据区域显示（创建时间、更新时间、最后编辑设备）

#### 2.2 修改内容
- [ ] 修改标题文本
- [ ] 修改内容文本
- [ ] 验证修改后自动保存触发
- [ ] 验证修改内容正确保存

#### 2.3 元数据验证
- [ ] 验证创建时间格式正确（YYYY/MM/DD HH:MM:SS）
- [ ] 验证更新时间在修改后更新
- [ ] 验证最后编辑设备显示正确

### 3. 空内容处理

#### 3.1 新建模式空内容
- [ ] 打开新建编辑器
- [ ] 不输入任何内容
- [ ] 点击关闭按钮
- [ ] 验证直接关闭，不显示确认对话框

#### 3.2 编辑模式空内容
- [ ] 打开现有笔记
- [ ] 清空所有内容
- [ ] 点击"完成"按钮
- [ ] 验证显示"内容不能为空"提示
- [ ] 验证笔记未保存

#### 3.3 空标题处理
- [ ] 打开新建编辑器
- [ ] 只输入内容，不输入标题
- [ ] 点击"完成"按钮
- [ ] 验证笔记保存成功
- [ ] 验证标题自动填充为"无标题笔记"

### 4. 未保存更改确认

#### 4.1 显示确认对话框
- [ ] 打开现有笔记
- [ ] 修改内容
- [ ] 在自动保存触发前（< 1秒）点击关闭按钮
- [ ] 验证显示"有未保存的更改"对话框
- [ ] 验证对话框显示三个按钮（取消、放弃更改、保存并关闭）

#### 4.2 取消操作
- [ ] 在确认对话框中点击"取消"
- [ ] 验证对话框关闭
- [ ] 验证返回编辑器继续编辑

#### 4.3 放弃更改
- [ ] 修改内容后点击关闭
- [ ] 在确认对话框中点击"放弃更改"
- [ ] 验证编辑器关闭
- [ ] 验证修改未保存

#### 4.4 保存并关闭
- [ ] 修改内容后点击关闭
- [ ] 在确认对话框中点击"保存并关闭"
- [ ] 验证修改保存成功
- [ ] 验证编辑器关闭

### 5. 边界情况测试

#### 5.1 超长标题
- [ ] 输入超过 100 个字符的标题
- [ ] 验证标题正确显示和保存
- [ ] 验证界面不会溢出或崩溃

#### 5.2 超长内容
- [ ] 输入超过 1000 行的内容
- [ ] 验证滚动流畅
- [ ] 验证保存成功
- [ ] 验证性能无明显下降

#### 5.3 特殊字符
- [ ] 输入 Emoji 表情符号
- [ ] 输入中文、英文、日文混合文本
- [ ] 输入特殊符号（@#$%^&*）
- [ ] 验证所有字符正确显示和保存

#### 5.4 快速操作
- [ ] 快速连续点击"完成"按钮
- [ ] 验证只保存一次
- [ ] 快速打开和关闭编辑器多次
- [ ] 验证无崩溃或内存泄漏

### 6. 可访问性测试

#### 6.1 屏幕阅读器
- [ ] 启用 VoiceOver (iOS) 或 TalkBack (Android)
- [ ] 验证所有按钮有正确的语音标签
- [ ] 验证输入框有正确的提示信息
- [ ] 验证对话框内容可被正确朗读

#### 6.2 键盘导航
- [ ] 使用 Tab 键在元素间导航
- [ ] 验证焦点顺序合理
- [ ] 使用 Enter 键激活按钮
- [ ] 验证键盘操作流畅

### 7. 性能测试

#### 7.1 启动性能
- [ ] 测量编辑器打开时间（应 < 300ms）
- [ ] 测量编辑器关闭时间（应 < 300ms）
- [ ] 验证动画流畅度（60fps）

#### 7.2 内存使用
- [ ] 打开编辑器前记录内存使用
- [ ] 打开编辑器后记录内存使用
- [ ] 验证内存增长 < 10MB
- [ ] 关闭编辑器后验证内存释放

#### 7.3 长时间使用
- [ ] 连续编辑 10 分钟
- [ ] 验证无性能下降
- [ ] 验证无内存泄漏
- [ ] 验证自动保存持续工作

### 8. 集成测试

#### 8.1 与主屏幕集成
- [ ] 从主屏幕打开编辑器
- [ ] 保存后验证笔记出现在列表中
- [ ] 编辑后验证笔记更新

#### 8.2 与 Rust 后端集成
- [ ] 验证 createCard API 调用成功
- [ ] 验证 updateCard API 调用成功
- [ ] 验证数据正确存储到 SQLite
- [ ] 验证 Loro CRDT 同步正常

## 测试结果记录

### 通过的测试场景
- [ ] 新建笔记流程
- [ ] 编辑现有笔记流程
- [ ] 空内容处理
- [ ] 未保存更改确认
- [ ] 边界情况测试
- [ ] 可访问性测试
- [ ] 性能测试
- [ ] 集成测试

### 发现的问题
（记录测试过程中发现的任何问题）

### 测试总结
- **测试日期**: ___________
- **测试人员**: ___________
- **测试设备**: ___________
- **测试结果**: 通过 / 失败
- **备注**: ___________

## 验收标准

所有测试场景必须通过，包括：
1. ✅ 基本功能正常工作
2. ✅ 自动保存机制正确
3. ✅ 未保存更改确认正常
4. ✅ 边界情况处理正确
5. ✅ 可访问性支持完整
6. ✅ 性能指标达标
7. ✅ 与后端集成正常

## 注意事项

1. 测试时注意观察控制台日志，记录任何错误或警告
2. 使用真机测试以获得最准确的性能数据
3. 测试不同屏幕尺寸和方向（竖屏/横屏）
4. 测试不同系统版本（iOS 14+, Android 8+）
5. 记录任何用户体验问题或改进建议
