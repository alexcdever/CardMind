## Context

当前 CardMind 移动端应用缺少底部导航栏组件，用户在笔记、设备和设置页面间切换不便。基于 React UI 参考实现和 OpenSpec 现有规格，需要实现符合移动端设计规范的底部导航栏。

**当前状态**:
- 移动端应用架构已建立
- 主题系统支持浅色/深色模式
- 状态管理使用 Provider 模式
- 缺少导航组件和页面切换逻辑

**约束条件**:
- 必须遵循移动端平台特定设计（非响应式）
- 需要与 React UI 参考实现保持视觉一致
- 支持无障碍访问标准
- 性能要求：动画流畅 60fps

## Goals / Non-Goals

**Goals:**
- 实现符合 Material Design 移动端规范的底部导航栏
- 提供直观的标签切换体验和视觉反馈
- 支持徽章通知功能，实时显示笔记和设备数量
- 确保组件可访问性和多主题适配
- 建立完整的测试覆盖（5 个单元测试 + 41 个 Widget 测试）

**Non-Goals:**
- 不实现响应式布局（仅移动端）
- 不包含页面内容切换逻辑（仅导航组件）
- 不支持自定义标签配置（固定 3 个标签）
- 不实现拖拽重排等高级交互

## Decisions

### 1. 组件架构选择
**决策**: 使用 StatelessWidget 而非 StatefulWidget
**理由**: 
- 导航状态由外部状态管理（Provider）控制
- 组件本身只负责渲染，状态变化触发重建
- 更好的性能和可测试性

**替代方案考虑**: StatefulWidget - 会导致状态管理分散，不符合项目架构模式

### 2. 动画实现方式
**决策**: 使用 AnimatedContainer 和 Tween 动画
**理由**:
- Flutter 内置组件，性能优化良好
- 支持颜色、尺寸、透明度等多种属性动画
- 与设计文档要求的 200ms 时长匹配

**替代方案考虑**: 手动 AnimationController - 复杂度高，维护成本大

### 3. 徽章显示逻辑
**决策**: 封装独立的 BadgeWidget 组件
**理由**:
- 单一职责原则，徽章逻辑独立
- 可复用于其他需要徽章的组件
- 便于测试和维护

**替代方案考虑**: 在 NavTabItem 中直接绘制 - 代码耦合度高，不易复用

### 4. 主题适配策略
**决策**: 使用 Theme.of(context) 动态获取颜色
**理由**:
- 自动支持浅色/深色模式切换
- 与项目现有主题系统一致
- 无需手动管理主题状态

**替代方案考虑**: 硬编码颜色值 - 不支持主题切换，违反设计原则

### 5. 触摸反馈实现
**决策**: 使用 InkWell + MaterialStateProperty
**理由**:
- 标准 Material Design 触摸反馈
- 自动处理水波纹效果
- 支持不同状态的颜色变化

**替代方案考虑**: GestureDetector + 手动状态管理 - 重复造轮子，不符合 Material Design 规范

## Risks / Trade-offs

### 性能风险
[Risk] 频繁的状态重建可能导致性能问题
→ **缓解措施**: 使用 const 构造函数，避免不必要的重建，仅在徽章数字变化时重建徽章组件

### 兼容性风险
[Risk] 不同屏幕尺寸的布局适配问题
→ **缓解措施**: 使用 Flexible 和 Expanded 组件，确保在 320px+ 宽度下正常显示

### 可访问性风险
[Risk] 语义化标签可能不够完善
→ **缓解措施**: 添加 Semantics widget，提供详细的语义化描述

### 维护风险
[Risk] 硬编码的动画时长和颜色值
→ **缓解措施**: 定义常量类，集中管理设计令牌

## Migration Plan

### 部署步骤
1. 创建 `lib/widgets/mobile_nav/` 目录结构
2. 实现 MobileNav 和 NavTabItem 组件
3. 添加单元测试和 Widget 测试
4. 集成到主页面并连接状态管理
5. 验证主题适配和可访问性

### 回滚策略
- 组件独立封装，移除不影响现有功能
- 使用特性开关控制显示，便于快速回滚
- 保留原有页面导航逻辑作为备份

## Open Questions

1. **状态管理集成**: 是否需要创建专门的 NavigationState Provider，还是复用现有的应用状态？
2. **页面切换逻辑**: 导航组件是否应该负责页面切换，还是仅触发回调由父组件处理？
3. **徽章数据源**: 笔记和设备数量数据如何实时获取？是否需要添加数据监听机制？
4. **国际化支持**: 标签文本是否需要支持多语言？当前设计文档未提及国际化需求。