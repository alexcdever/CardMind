# SHA-256 密码校验架构规格

## 概述

本规格定义 CardMind 中数据池密码的最简哈希与校验机制。系统使用 SHA-256 计算密钥哈希，用于加入数据池与同步校验。

**技术栈**:
- sha2 = "0.10" - SHA-256 哈希
- hex = "0.4" - 哈希十六进制编码

---

## 需求：密码哈希

系统应提供对数据池密钥的 SHA-256 哈希能力。

### 场景：计算密钥哈希

- **前置条件**: 用户提供明文密钥字符串
- **操作**: 调用密钥哈希函数
- **预期结果**: 返回 64 字符十六进制哈希字符串

---

## 需求：密码验证

系统应验证用户提供的密钥哈希是否与池内密钥匹配。

### 场景：验证密钥哈希

- **前置条件**: 用户输入密钥哈希与池内明文密钥
- **操作**: 调用密钥校验函数
- **预期结果**: 返回布尔值表示是否匹配

---

## 非目标

本阶段不提供以下能力：
- 密钥强度校验
- 时间戳校验与防重放
- 内存清零
- Keyring 安全存储

---

## 相关文档

**相关规格**:
- [../../domain/pool.md](../../domain/pool.md) - 数据池领域模型
- [../sync/peer_discovery.md](../sync/peer_discovery.md) - mDNS 设备发现

**架构决策记录**:

---

## 测试覆盖

**测试文件**: `rust/tests/security_password_feature_test.rs`

**单元测试**:
- `it_should_hash_secretkey_with_sha256()` - 测试密钥哈希
- `it_should_verify_secretkey_hash_successfully()` - 测试校验成功
- `it_should_verify_secretkey_hash_failure()` - 测试校验失败

**验收标准**:
- [x] 所有单元测试通过
- [x] 哈希结果为 64 字符十六进制字符串
- [x] 校验返回布尔值
- [x] 文档已更新
