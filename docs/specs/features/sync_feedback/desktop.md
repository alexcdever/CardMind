# 桌面端同步状态指示器规格


---


本规格定义了桌面端同步状态指示器 widget，使用 Badge 组件提供关于同步状态的实时视觉反馈。设计基于 React UI 参考实现。

### 适用平台

- macOS
- Windows
- Linux


**注意**：移动端平台（Android、iOS、iPadOS）不在应用栏中显示同步状态指示器。移动端用户可以通过设置或设备标签页访问同步信息。


---


系统应实现四状态同步状态机。


- **操作**：应用启动且从未同步过
- **预期结果**：同步状态为 `notYetSynced`
- **并且**：lastSyncTime 为 null


- **操作**：用户触发同步或自动同步启动
- **预期结果**：同步状态转换为 `syncing`


- **操作**：同步成功完成
- **预期结果**：同步状态转换为 `synced`
- **并且**：lastSyncTime 设置为当前时间戳


- **操作**：同步因错误失败
- **预期结果**：同步状态转换为 `failed`
- **并且**：errorMessage 被设置


- **操作**：检测到新更改或用户手动触发同步
- **预期结果**：同步状态转换为 `syncing`


- **操作**：用户重试同步
- **预期结果**：同步状态转换为 `syncing`


---


系统应在应用从未同步时显示尚未同步指示器。


- **操作**：同步状态为 `notYetSynced`
- **预期结果**：指示器显示灰色 Badge 组件


- **操作**：同步状态为 `notYetSynced`
- **预期结果**：Badge 显示 CloudOff 图标


- **操作**：同步状态为 `notYetSynced`
- **预期结果**：Badge 显示文本"尚未同步"


- **操作**：同步状态为 `notYetSynced`
- **预期结果**：图标静止（无动画）


---


系统应在同步进行中时显示同步中指示器。


- **操作**：同步状态为 `syncing`
- **预期结果**：指示器显示次要色 Badge 组件


- **操作**：同步状态为 `syncing`
- **预期结果**：Badge 显示 RefreshCw 图标


- **操作**：同步状态为 `syncing`
- **预期结果**：Badge 显示文本"同步中..."


- **操作**：同步状态为 `syncing`
- **预期结果**：图标持续旋转（每 2 秒 360°）


---


系统应在同步完成时显示已同步指示器。


- **操作**：同步状态为 `synced`
- **预期结果**：指示器显示绿色 Badge 组件


- **操作**：同步状态为 `synced`
- **预期结果**：Badge 显示 CloudCheck 图标


- **操作**：同步状态为 `synced`
- **预期结果**：Badge 显示文本"已同步"


- **操作**：同步状态为 `synced`
- **预期结果**：图标静止（无动画）


- **操作**：同步状态为 `synced`
- **预期结果**：显示相对时间（例如"刚刚"、"5 分钟前"）


---


系统应在同步失败时显示失败指示器。


- **操作**：同步状态为 `failed`
- **预期结果**：指示器显示红色 Badge 组件


- **操作**：同步状态为 `failed`
- **预期结果**：Badge 显示 CloudOff 图标带警告徽章


- **操作**：同步状态为 `failed`
- **预期结果**：Badge 显示文本"同步失败"


- **操作**：同步状态为 `failed`
- **预期结果**：图标静止（无动画）


- **操作**：同步状态为 `failed`
- **预期结果**：点击显示错误详情和重试按钮


---


系统应使用一致的 Badge 组件样式。


- **操作**：Badge 显示
- **预期结果**：使用圆角（borderRadius: 4）
- **并且**：有适当的内边距（padding: 8px 12px）
- **并且**：有微妙的阴影


- **操作**：Badge 图标
- **预期结果**：图标大小为 16px
- **并且**：图标与文本间距为 6px


- **操作**：Badge 文本
- **预期结果**：文本大小为 12px
- **并且**：文本粗细为中等


---


**最后更新**: 2026-01-23
**作者**: CardMind Team
