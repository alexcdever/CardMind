# CardMind è§„æ ¼-æµ‹è¯•éªŒè¯è®¡åˆ’
# Spec-Test Validation Plan

**åˆ›å»ºæ—¥æœŸ**: 2026-02-01
**çŠ¶æ€**: å¾…æ‰§è¡Œ
**æ‰§è¡Œæ–¹å¼**: Superpowers ExecutePlan å·¥ä½œæµ

---

## æ‰§è¡Œæ‘˜è¦

### ç›®æ ‡

å¯¹ CardMind é¡¹ç›®çš„æ‰€æœ‰æµ‹è¯•ä»£ç è¿›è¡Œå…¨é¢éªŒè¯ï¼Œç¡®ä¿æµ‹è¯•å®ç°ä¸è§„æ ¼æ–‡æ¡£å®Œå…¨ä¸€è‡´ã€‚

### èƒŒæ™¯

CardMind é‡‡ç”¨ Spec Coding æ–¹æ³•è®ºï¼ˆæµ‹è¯•å³è§„æ ¼ï¼Œè§„æ ¼å³æ–‡æ¡£ï¼‰ï¼Œæ‹¥æœ‰ 67 ä¸ªè§„æ ¼æ–‡æ¡£ï¼Œåˆ†å¸ƒåœ¨å››å±‚æ¶æ„ä¸­ï¼š
- **Domain Layer**: 5 ä¸ªè§„æ ¼ï¼ˆé¢†åŸŸæ¨¡å‹å’Œä¸šåŠ¡è§„åˆ™ï¼‰
- **Architecture Layer**: 15 ä¸ªè§„æ ¼ï¼ˆæŠ€æœ¯å®ç°ï¼‰
- **Features Layer**: 5 ä¸ªè§„æ ¼ï¼ˆç”¨æˆ·åŠŸèƒ½ï¼‰
- **UI Layer**: 32 ä¸ªè§„æ ¼ï¼ˆå±å¹• + ç»„ä»¶ + è‡ªé€‚åº”ï¼‰
- **Legacy**: 5 ä¸ªè§„æ ¼ï¼ˆAPI + UI Systemï¼‰

### é—®é¢˜é™ˆè¿°

ç›®å‰ç¼ºä¹ç³»ç»ŸåŒ–çš„éªŒè¯æœºåˆ¶ï¼Œæ— æ³•ç¡®ä¿æµ‹è¯•ä»£ç æ˜¯å¦å®Œæ•´è¦†ç›–è§„æ ¼æ–‡æ¡£ä¸­å®šä¹‰çš„æ‰€æœ‰åœºæ™¯ã€å‰ç½®æ¡ä»¶å’Œåç½®æ¡ä»¶ã€‚è¿™å¯èƒ½å¯¼è‡´ï¼š
1. è§„æ ¼æ–‡æ¡£ä¸å®é™…æµ‹è¯•ä¸ä¸€è‡´
2. å…³é”®åœºæ™¯ç¼ºå°‘æµ‹è¯•è¦†ç›–
3. æµ‹è¯•å‘½åä¸è§„èŒƒï¼Œéš¾ä»¥è¿½æº¯åˆ°è§„æ ¼
4. GIVEN-WHEN-THEN ä¸‰æ®µå¼ä¸å®Œæ•´

### é¢„æœŸæˆæœ

1. **éªŒè¯æŠ¥å‘Š**: ç”Ÿæˆè¯¦ç»†çš„ Markdown æŠ¥å‘Šï¼ˆ`docs/reports/spec-test-validation-report.md`ï¼‰
2. **ä¸ç¬¦åˆé¡¹æ¸…å•**: æ¸…æ™°åˆ—å‡ºæ‰€æœ‰ä¸ç¬¦åˆé¡¹ï¼ŒåŒ…æ‹¬ï¼š
   - ç¼ºå¤±çš„æµ‹è¯•æ–‡ä»¶
   - ç¼ºå¤±çš„åœºæ™¯æµ‹è¯•
   - ä¸ç¬¦åˆå‘½åè§„èŒƒçš„æµ‹è¯•
   - ä¸å®Œæ•´çš„ GIVEN-WHEN-THEN ç»“æ„
   - ä¸å……åˆ†çš„æ–­è¨€
3. **æ”¹è¿›å»ºè®®**: ä¸ºæ¯ä¸ªä¸ç¬¦åˆé¡¹æä¾›å…·ä½“çš„æ”¹è¿›å»ºè®®å’Œä¼˜å…ˆçº§
4. **ç»Ÿè®¡æ‘˜è¦**: æä¾›è¦†ç›–ç‡ã€åˆè§„ç‡ç­‰å…³é”®æŒ‡æ ‡

---

## å®æ–½ç­–ç•¥

### éªŒè¯æ–¹æ³•è®º

é‡‡ç”¨**å››é˜¶æ®µéªŒè¯æµç¨‹**ï¼š

#### é˜¶æ®µ 1: è§„æ ¼-æµ‹è¯•æ˜ å°„åˆ†æ
- æ‰«æ `openspec/specs/` ä¸‹æ‰€æœ‰è§„æ ¼æ–‡æ¡£
- è¯†åˆ«æ¯ä¸ªè§„æ ¼ä¸­å®šä¹‰çš„ Requirements å’Œ Scenarios
- æŸ¥æ‰¾å¯¹åº”çš„æµ‹è¯•æ–‡ä»¶ï¼ˆé€šè¿‡ `Related Tests` å­—æ®µæˆ–å‘½åçº¦å®šï¼‰
- ç”Ÿæˆè§„æ ¼-æµ‹è¯•æ˜ å°„è¡¨

**å·¥å…·**:
- `find` + `grep`: æŸ¥æ‰¾è§„æ ¼æ–‡æ¡£
- `grep -E "## Requirement:|### Scenario:"`: æå–åœºæ™¯
- `grep -E "Related Tests:"`: æå–æµ‹è¯•æ–‡ä»¶è·¯å¾„

#### é˜¶æ®µ 2: åœºæ™¯è¦†ç›–åº¦éªŒè¯
- å¯¹æ¯ä¸ªè§„æ ¼ä¸­çš„ Scenarioï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹
- éªŒè¯æµ‹è¯•å‘½åæ˜¯å¦ç¬¦åˆ `it_should_xxx()` è§„èŒƒ
- æ£€æŸ¥ GIVEN-WHEN-THEN ä¸‰æ®µå¼æ˜¯å¦å®Œæ•´
- è¯†åˆ«ç¼ºå¤±çš„åœºæ™¯æµ‹è¯•

**å·¥å…·**:
- `ast-grep`: æœç´¢ Rust æµ‹è¯•å‡½æ•°
- `grep -E "#\[test\]"`: æŸ¥æ‰¾ Rust æµ‹è¯•
- `grep -E "test\('.*'\)"`: æŸ¥æ‰¾ Dart æµ‹è¯•
- æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… `it_should_xxx` æ¨¡å¼

#### é˜¶æ®µ 3: æµ‹è¯•å®ç°è´¨é‡æ£€æŸ¥
- åˆ†ææµ‹è¯•ä»£ç çš„æ–­è¨€ï¼ˆassertionsï¼‰
- éªŒè¯æ˜¯å¦æ­£ç¡®æµ‹è¯•äº†åç½®æ¡ä»¶ï¼ˆTHENï¼‰
- æ£€æŸ¥è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯å¤„ç†
- è¯„ä¼°æµ‹è¯•çš„å®Œæ•´æ€§

**å·¥å…·**:
- `grep -E "assert|expect"`: æŸ¥æ‰¾æ–­è¨€
- `grep -E "// Given:|// When:|// Then:"`: æ£€æŸ¥æ³¨é‡Š
- LSP å·¥å…·: åˆ†æä»£ç ç»“æ„

#### é˜¶æ®µ 4: æŠ¥å‘Šç”Ÿæˆ
- æ±‡æ€»æ‰€æœ‰ä¸ç¬¦åˆé¡¹
- æŒ‰ä¸¥é‡ç¨‹åº¦åˆ†ç±»ï¼ˆCritical/High/Medium/Lowï¼‰
- ä¸ºæ¯ä¸ªé—®é¢˜æä¾›å…·ä½“çš„ä»£ç ä½ç½®å’Œæ”¹è¿›å»ºè®®
- ç”Ÿæˆç»Ÿè®¡æ‘˜è¦ï¼ˆè¦†ç›–ç‡ã€åˆè§„ç‡ç­‰ï¼‰

---

## éªŒè¯èŒƒå›´

### Rust æµ‹è¯•éªŒè¯ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

**ç›®æ ‡æ–‡ä»¶**: `rust/tests/*_spec.rs` å’Œ `rust/tests/*_test.rs`

**å¯¹åº”è§„æ ¼**: Domain Layer + Architecture Layer

**å…³é”®è§„æ ¼æ–‡ä»¶**:
- `domain/pool/model.md` â†’ `rust/tests/sp_spm_001_spec.rs`
- `domain/card/model.md` â†’ `rust/tests/card_model_test.rs`
- `architecture/sync/service.md` â†’ `rust/tests/sp_sync_006_spec.rs`
- `architecture/sync/peer_discovery.md` â†’ `rust/tests/sp_mdns_001_spec.rs`
- `architecture/storage/dual_layer.md` â†’ ç›¸å…³æµ‹è¯•

**éªŒè¯é‡ç‚¹**:
- æµ‹è¯•å‘½åè§„èŒƒ (`it_should_xxx()`)
- GIVEN-WHEN-THEN æ³¨é‡Šå®Œæ•´æ€§
- Result<T, Error> é”™è¯¯å¤„ç†æµ‹è¯•
- æ–­è¨€è¦†ç›–æ‰€æœ‰åç½®æ¡ä»¶

### Flutter æµ‹è¯•éªŒè¯ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰

**ç›®æ ‡æ–‡ä»¶**: `test/**/*_test.dart`

**å¯¹åº”è§„æ ¼**: Features Layer + UI Layer

**å…³é”®è§„æ ¼æ–‡ä»¶**:
- `features/card_management/spec.md`
- `features/pool_management/spec.md`
- `ui/screens/mobile/home_screen.md`
- `ui/components/shared/note_card.md`

**éªŒè¯é‡ç‚¹**:
- Widget æµ‹è¯•è¦†ç›–
- ç”¨æˆ·äº¤äº’åœºæ™¯æµ‹è¯•
- çŠ¶æ€ç®¡ç†æµ‹è¯•
- æµ‹è¯•å‘½åè§„èŒƒ

### ä¼˜å…ˆçº§æ’åº

1. **Critical**: Domain Layer è§„æ ¼ï¼ˆä¸šåŠ¡æ ¸å¿ƒé€»è¾‘ï¼‰
2. **High**: Architecture Layer è§„æ ¼ï¼ˆæŠ€æœ¯å®ç°ï¼‰
3. **Medium**: Features Layer è§„æ ¼ï¼ˆç”¨æˆ·åŠŸèƒ½ï¼‰
4. **Low**: UI Layer è§„æ ¼ï¼ˆç•Œé¢ç»„ä»¶ï¼‰

### æ’é™¤é¡¹

- Legacy è§„æ ¼ï¼ˆæ ‡è®°ä¸ºå¼ƒç”¨ï¼‰
- å ä½ç¬¦è§„æ ¼ï¼ˆçŠ¶æ€ä¸º ğŸ“ï¼‰
- æ²¡æœ‰ `Related Tests` å­—æ®µä¸”å°šæœªå®ç°çš„è§„æ ¼

---

## ä¸ç¬¦åˆé¡¹åˆ†ç±»ä½“ç³»

### ç±»å‹ A: ç¼ºå¤±çš„æµ‹è¯•æ–‡ä»¶
- **ä¸¥é‡ç¨‹åº¦**: Critical
- **æè¿°**: è§„æ ¼æ–‡æ¡£æŒ‡å®šäº†æµ‹è¯•æ–‡ä»¶ï¼Œä½†æ–‡ä»¶ä¸å­˜åœ¨
- **ç¤ºä¾‹**: `domain/card/model.md` æŒ‡å®š `Related Tests: rust/tests/card_model_test.rs`ï¼Œä½†æ–‡ä»¶ç¼ºå¤±
- **æ”¹è¿›å»ºè®®**: åˆ›å»ºæµ‹è¯•æ–‡ä»¶å¹¶å®ç°æ‰€æœ‰åœºæ™¯

### ç±»å‹ B: ç¼ºå¤±çš„åœºæ™¯æµ‹è¯•
- **ä¸¥é‡ç¨‹åº¦**: High
- **æè¿°**: è§„æ ¼å®šä¹‰äº† Scenarioï¼Œä½†æ²¡æœ‰å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹
- **ç¤ºä¾‹**: è§„æ ¼å®šä¹‰ "Scenario: Device rejects joining second pool"ï¼Œä½†æµ‹è¯•æ–‡ä»¶ä¸­æ²¡æœ‰ `it_should_reject_joining_second_pool_xxx()` æµ‹è¯•
- **æ”¹è¿›å»ºè®®**: æ·»åŠ ç¼ºå¤±çš„æµ‹è¯•ç”¨ä¾‹

### ç±»å‹ C: æµ‹è¯•å‘½åä¸è§„èŒƒ
- **ä¸¥é‡ç¨‹åº¦**: Medium
- **æè¿°**: æµ‹è¯•å­˜åœ¨ä½†å‘½åä¸ç¬¦åˆ `it_should_xxx()` è§„èŒƒ
- **ç¤ºä¾‹**: `test_device_can_join_pool()` åº”æ”¹ä¸º `it_should_allow_joining_first_pool_successfully()`
- **æ”¹è¿›å»ºè®®**: é‡å‘½åæµ‹è¯•å‡½æ•°

### ç±»å‹ D: GIVEN-WHEN-THEN ä¸å®Œæ•´
- **ä¸¥é‡ç¨‹åº¦**: Medium
- **æè¿°**: æµ‹è¯•ä»£ç ç¼ºå°‘å‰ç½®æ¡ä»¶ã€æ“ä½œæˆ–é¢„æœŸç»“æœçš„æ³¨é‡Šæˆ–å®ç°
- **ç¤ºä¾‹**: æµ‹è¯•åªæœ‰ WHEN å’Œ THENï¼Œç¼ºå°‘ GIVEN æ³¨é‡Š
- **æ”¹è¿›å»ºè®®**: è¡¥å……å®Œæ•´çš„ä¸‰æ®µå¼ç»“æ„

### ç±»å‹ E: æ–­è¨€ä¸å……åˆ†
- **ä¸¥é‡ç¨‹åº¦**: Low
- **æè¿°**: æµ‹è¯•æ²¡æœ‰éªŒè¯è§„æ ¼ä¸­å®šä¹‰çš„æ‰€æœ‰åç½®æ¡ä»¶
- **ç¤ºä¾‹**: è§„æ ¼è¦æ±‚éªŒè¯ "pool_id == Some(...)" AND "sync begins"ï¼Œä½†æµ‹è¯•åªéªŒè¯äº† pool_id
- **æ”¹è¿›å»ºè®®**: æ·»åŠ ç¼ºå¤±çš„æ–­è¨€

---

## è¯¦ç»†ä»»åŠ¡åˆ†è§£

### é˜¶æ®µ 1: å‡†å¤‡å·¥ä½œï¼ˆé¢„è®¡ 30 åˆ†é’Ÿï¼‰

#### ä»»åŠ¡ 1.1: æ‰«ææ‰€æœ‰è§„æ ¼æ–‡æ¡£
- **è¾“å…¥**: `openspec/specs/` ç›®å½•
- **è¾“å‡º**: è§„æ ¼æ–‡æ¡£åˆ—è¡¨ï¼ˆ67 ä¸ªæ–‡æ¡£ï¼‰
- **å·¥å…·**: `find openspec/specs -name "*.md"`

#### ä»»åŠ¡ 1.2: æå– Requirements å’Œ Scenarios
- **è¾“å…¥**: æ¯ä¸ªè§„æ ¼æ–‡æ¡£
- **è¾“å‡º**: Requirements å’Œ Scenarios åˆ—è¡¨
- **å·¥å…·**: `grep -E "## Requirement:|### Scenario:"`

#### ä»»åŠ¡ 1.3: è¯†åˆ«æµ‹è¯•æ–‡ä»¶è·¯å¾„
- **è¾“å…¥**: è§„æ ¼æ–‡æ¡£ä¸­çš„ `Related Tests` å­—æ®µ
- **è¾“å‡º**: è§„æ ¼-æµ‹è¯•æ˜ å°„è¡¨
- **å·¥å…·**: `grep -E "Related Tests:"`

#### ä»»åŠ¡ 1.4: æ‰«ææ‰€æœ‰æµ‹è¯•æ–‡ä»¶
- **è¾“å…¥**: `rust/tests/` å’Œ `test/` ç›®å½•
- **è¾“å‡º**: æµ‹è¯•æ–‡ä»¶åˆ—è¡¨
- **å·¥å…·**: `find rust/tests -name "*_spec.rs" -o -name "*_test.rs"` å’Œ `find test -name "*_test.dart"`

---

### é˜¶æ®µ 2: Domain Layer éªŒè¯ï¼ˆé¢„è®¡ 45 åˆ†é’Ÿï¼‰

#### ä»»åŠ¡ 2.1: éªŒè¯ domain/pool/model.md
- **è§„æ ¼æ–‡ä»¶**: `openspec/specs/domain/pool/model.md`
- **æµ‹è¯•æ–‡ä»¶**: `rust/tests/sp_spm_001_spec.rs`
- **éªŒè¯å†…å®¹**:
  - âœ… æµ‹è¯•æ–‡ä»¶å­˜åœ¨
  - âœ… Scenario: "Device joins first pool successfully" â†’ `it_should_allow_joining_first_pool_successfully()`
  - âœ… Scenario: "Device rejects joining second pool" â†’ `it_should_reject_joining_second_pool_when_already_joined()`
  - â“ Scenario: "Device leaves pool and clears data" â†’ æ£€æŸ¥æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•
  - â“ Scenario: "Create card auto-joins the pool" â†’ æ£€æŸ¥æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•
  - â“ Scenario: "Create card fails when no pool joined" â†’ æ£€æŸ¥æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•

#### ä»»åŠ¡ 2.2: éªŒè¯ domain/card/model.md
- **è§„æ ¼æ–‡ä»¶**: `openspec/specs/domain/card/model.md`
- **æµ‹è¯•æ–‡ä»¶**: å¾…æŸ¥æ‰¾
- **éªŒè¯å†…å®¹**:
  - â“ æµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨
  - â“ æ‰€æœ‰ Scenarios æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•

#### ä»»åŠ¡ 2.3: éªŒè¯ domain/card/rules.md
- **è§„æ ¼æ–‡ä»¶**: `openspec/specs/domain/card/rules.md`
- **æµ‹è¯•æ–‡ä»¶**: å¾…æŸ¥æ‰¾
- **éªŒè¯å†…å®¹**:
  - â“ æµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨
  - â“ æ‰€æœ‰ Scenarios æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•

#### ä»»åŠ¡ 2.4: éªŒè¯ domain/sync/model.md
- **è§„æ ¼æ–‡ä»¶**: `openspec/specs/domain/sync/model.md`
- **æµ‹è¯•æ–‡ä»¶**: å¾…æŸ¥æ‰¾
- **éªŒè¯å†…å®¹**:
  - â“ æµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨
  - â“ æ‰€æœ‰ Scenarios æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•

#### ä»»åŠ¡ 2.5: éªŒè¯ domain/types.md
- **è§„æ ¼æ–‡ä»¶**: `openspec/specs/domain/types.md`
- **æµ‹è¯•æ–‡ä»¶**: å¾…æŸ¥æ‰¾
- **éªŒè¯å†…å®¹**:
  - â“ æ˜¯å¦éœ€è¦æµ‹è¯•ï¼ˆç±»å‹å®šä¹‰å¯èƒ½ä¸éœ€è¦ç‹¬ç«‹æµ‹è¯•ï¼‰

---

### é˜¶æ®µ 3: Architecture Layer éªŒè¯ï¼ˆé¢„è®¡ 60 åˆ†é’Ÿï¼‰

#### ä»»åŠ¡ 3.1: éªŒè¯ Storage è§„æ ¼ï¼ˆ6 ä¸ªæ–‡æ¡£ï¼‰
- `architecture/storage/dual_layer.md`
- `architecture/storage/card_store.md`
- `architecture/storage/pool_store.md`
- `architecture/storage/device_config.md`
- `architecture/storage/loro_integration.md`
- `architecture/storage/sqlite_cache.md`

**éªŒè¯å†…å®¹**:
- â“ æ¯ä¸ªè§„æ ¼æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•æ–‡ä»¶
- â“ æ‰€æœ‰ Scenarios æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•
- â“ æµ‹è¯•å‘½åæ˜¯å¦è§„èŒƒ

#### ä»»åŠ¡ 3.2: éªŒè¯ Sync è§„æ ¼ï¼ˆ4 ä¸ªæ–‡æ¡£ï¼‰
- `architecture/sync/service.md` â†’ `rust/tests/sp_sync_006_spec.rs`
- `architecture/sync/peer_discovery.md` â†’ `rust/tests/sp_mdns_001_spec.rs`
- `architecture/sync/conflict_resolution.md`
- `architecture/sync/subscription.md`

**éªŒè¯å†…å®¹**:
- âœ… `sp_sync_006_spec.rs` å’Œ `sp_mdns_001_spec.rs` å­˜åœ¨
- â“ å…¶ä»–è§„æ ¼æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•
- â“ æ‰€æœ‰ Scenarios æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•

#### ä»»åŠ¡ 3.3: éªŒè¯ Security è§„æ ¼ï¼ˆ3 ä¸ªæ–‡æ¡£ï¼‰
- `architecture/security/password.md`
- `architecture/security/keyring.md`
- `architecture/security/privacy.md`

**éªŒè¯å†…å®¹**:
- â“ æ¯ä¸ªè§„æ ¼æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•æ–‡ä»¶
- â“ æ‰€æœ‰ Scenarios æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•

#### ä»»åŠ¡ 3.4: éªŒè¯ Bridge è§„æ ¼ï¼ˆ1 ä¸ªæ–‡æ¡£ï¼‰
- `architecture/bridge/flutter_rust_bridge.md`

**éªŒè¯å†…å®¹**:
- â“ æ˜¯å¦æœ‰é›†æˆæµ‹è¯•
- â“ FFI æ¥å£æ˜¯å¦æœ‰æµ‹è¯•è¦†ç›–

---

### é˜¶æ®µ 4: Features Layer éªŒè¯ï¼ˆé¢„è®¡ 45 åˆ†é’Ÿï¼‰

#### ä»»åŠ¡ 4.1: éªŒè¯ card_management è§„æ ¼
- **è§„æ ¼æ–‡ä»¶**: `features/card_management/spec.md`
- **æµ‹è¯•æ–‡ä»¶**: å¾…æŸ¥æ‰¾ï¼ˆå¯èƒ½åœ¨ `test/features/` æˆ– `test/integration/`ï¼‰
- **éªŒè¯å†…å®¹**:
  - â“ æµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨
  - â“ æ‰€æœ‰ç”¨æˆ·åœºæ™¯æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•

#### ä»»åŠ¡ 4.2: éªŒè¯ pool_management è§„æ ¼
- **è§„æ ¼æ–‡ä»¶**: `features/pool_management/spec.md`
- **æµ‹è¯•æ–‡ä»¶**: å¾…æŸ¥æ‰¾
- **éªŒè¯å†…å®¹**:
  - â“ æµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨
  - â“ æ‰€æœ‰ç”¨æˆ·åœºæ™¯æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•

#### ä»»åŠ¡ 4.3: éªŒè¯ p2p_sync è§„æ ¼
- **è§„æ ¼æ–‡ä»¶**: `features/p2p_sync/spec.md`
- **æµ‹è¯•æ–‡ä»¶**: å¾…æŸ¥æ‰¾
- **éªŒè¯å†…å®¹**:
  - â“ æµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨
  - â“ æ‰€æœ‰ç”¨æˆ·åœºæ™¯æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•

#### ä»»åŠ¡ 4.4: éªŒè¯ search_and_filter è§„æ ¼
- **è§„æ ¼æ–‡ä»¶**: `features/search_and_filter/spec.md`
- **æµ‹è¯•æ–‡ä»¶**: å¾…æŸ¥æ‰¾
- **éªŒè¯å†…å®¹**:
  - â“ æµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨
  - â“ æ‰€æœ‰ç”¨æˆ·åœºæ™¯æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•

#### ä»»åŠ¡ 4.5: éªŒè¯ settings è§„æ ¼
- **è§„æ ¼æ–‡ä»¶**: `features/settings/spec.md`
- **æµ‹è¯•æ–‡ä»¶**: å¾…æŸ¥æ‰¾
- **éªŒè¯å†…å®¹**:
  - â“ æµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨
  - â“ æ‰€æœ‰ç”¨æˆ·åœºæ™¯æ˜¯å¦æœ‰å¯¹åº”æµ‹è¯•

---

### é˜¶æ®µ 5: UI Layer éªŒè¯ï¼ˆé¢„è®¡ 60 åˆ†é’Ÿï¼‰

#### ä»»åŠ¡ 5.1: éªŒè¯ Screens è§„æ ¼ï¼ˆ9 ä¸ªæ–‡æ¡£ï¼‰
- `ui/screens/mobile/home_screen.md`
- `ui/screens/desktop/home_screen.md`
- `ui/screens/mobile/card_editor_screen.md`
- `ui/screens/desktop/card_editor_screen.md`
- `ui/screens/mobile/card_detail_screen.md`
- `ui/screens/mobile/sync_screen.md`
- `ui/screens/mobile/settings_screen.md`
- `ui/screens/desktop/settings_screen.md`
- `ui/screens/shared/onboarding_screen.md`

**éªŒè¯å†…å®¹**:
- â“ æ¯ä¸ªå±å¹•æ˜¯å¦æœ‰ Widget æµ‹è¯•
- â“ ç”¨æˆ·äº¤äº’åœºæ™¯æ˜¯å¦æœ‰æµ‹è¯•è¦†ç›–
- â“ æµ‹è¯•æ–‡ä»¶ä½ç½®æ˜¯å¦ç¬¦åˆçº¦å®šï¼ˆ`test/ui/screens/`ï¼‰

#### ä»»åŠ¡ 5.2: éªŒè¯ Components è§„æ ¼ï¼ˆ14 ä¸ªæ–‡æ¡£ï¼‰
- Mobile ç»„ä»¶ï¼ˆ5 ä¸ªï¼‰
- Desktop ç»„ä»¶ï¼ˆ4 ä¸ªï¼‰
- Shared ç»„ä»¶ï¼ˆ5 ä¸ªï¼‰

**éªŒè¯å†…å®¹**:
- â“ æ¯ä¸ªç»„ä»¶æ˜¯å¦æœ‰ Widget æµ‹è¯•
- â“ ç»„ä»¶è¡Œä¸ºæ˜¯å¦æœ‰æµ‹è¯•è¦†ç›–
- â“ æµ‹è¯•æ–‡ä»¶ä½ç½®æ˜¯å¦ç¬¦åˆçº¦å®šï¼ˆ`test/ui/components/`ï¼‰

#### ä»»åŠ¡ 5.3: éªŒè¯ Adaptive System è§„æ ¼ï¼ˆ3 ä¸ªæ–‡æ¡£ï¼‰
- `ui/adaptive/layouts.md`
- `ui/adaptive/components.md`
- `ui/adaptive/platform_detection.md`

**éªŒè¯å†…å®¹**:
- â“ è‡ªé€‚åº”é€»è¾‘æ˜¯å¦æœ‰æµ‹è¯•
- â“ å¹³å°æ£€æµ‹æ˜¯å¦æœ‰æµ‹è¯•
- â“ å“åº”å¼å¸ƒå±€æ˜¯å¦æœ‰æµ‹è¯•

---

### é˜¶æ®µ 6: æŠ¥å‘Šç”Ÿæˆï¼ˆé¢„è®¡ 30 åˆ†é’Ÿï¼‰

#### ä»»åŠ¡ 6.1: æ±‡æ€»æ‰€æœ‰ä¸ç¬¦åˆé¡¹
- **è¾“å…¥**: é˜¶æ®µ 2-5 çš„éªŒè¯ç»“æœ
- **è¾“å‡º**: ä¸ç¬¦åˆé¡¹åˆ—è¡¨ï¼ˆæŒ‰ç±»å‹åˆ†ç±»ï¼‰
- **æ ¼å¼**: 
  ```
  {
    "type": "A|B|C|D|E",
    "severity": "Critical|High|Medium|Low",
    "spec_file": "path/to/spec.md",
    "test_file": "path/to/test.rs",
    "scenario": "Scenario name",
    "description": "è¯¦ç»†æè¿°",
    "suggestion": "æ”¹è¿›å»ºè®®"
  }
  ```

#### ä»»åŠ¡ 6.2: è®¡ç®—ç»Ÿè®¡æ•°æ®
- **æŒ‡æ ‡**:
  - è§„æ ¼æ–‡æ¡£æ€»æ•°: 67
  - æµ‹è¯•æ–‡ä»¶æ€»æ•°: ?
  - åœºæ™¯æ€»æ•°: ?
  - æµ‹è¯•ç”¨ä¾‹æ€»æ•°: ?
  - ä¸ç¬¦åˆé¡¹æ€»æ•°: ?
  - åˆè§„ç‡: (åœºæ™¯æ€»æ•° - ä¸ç¬¦åˆé¡¹) / åœºæ™¯æ€»æ•° * 100%
  - æŒ‰ç±»å‹ç»Ÿè®¡: A/B/C/D/E å„å¤šå°‘é¡¹
  - æŒ‰ä¸¥é‡ç¨‹åº¦ç»Ÿè®¡: Critical/High/Medium/Low å„å¤šå°‘é¡¹

#### ä»»åŠ¡ 6.3: ç”Ÿæˆ Markdown æŠ¥å‘Š
- **è¾“å‡ºæ–‡ä»¶**: `docs/reports/spec-test-validation-report.md`
- **æŠ¥å‘Šç»“æ„**: è§ä¸‹æ–‡"æŠ¥å‘Šç»“æ„æ¨¡æ¿"

#### ä»»åŠ¡ 6.4: ç”Ÿæˆæ”¹è¿›å»ºè®®ä¼˜å…ˆçº§åˆ—è¡¨
- **æ’åºè§„åˆ™**:
  1. Critical ä¼˜å…ˆ
  2. High æ¬¡ä¹‹
  3. Medium å†æ¬¡
  4. Low æœ€å
- **è¾“å‡º**: æŒ‰ä¼˜å…ˆçº§æ’åºçš„æ”¹è¿›å»ºè®®åˆ—è¡¨

---

## æŠ¥å‘Šç»“æ„æ¨¡æ¿

```markdown
# CardMind è§„æ ¼-æµ‹è¯•éªŒè¯æŠ¥å‘Š
# Spec-Test Validation Report

**éªŒè¯æ—¥æœŸ**: YYYY-MM-DD
**éªŒè¯èŒƒå›´**: æ‰€æœ‰æµ‹è¯•ï¼ˆRust + Flutterï¼‰
**éªŒè¯æ·±åº¦**: å®Œæ•´éªŒè¯

---

## æ‰§è¡Œæ‘˜è¦

### éªŒè¯ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°é‡ |
|------|------|
| è§„æ ¼æ–‡æ¡£æ€»æ•° | 67 |
| æµ‹è¯•æ–‡ä»¶æ€»æ•° | ? |
| åœºæ™¯æ€»æ•° | ? |
| æµ‹è¯•ç”¨ä¾‹æ€»æ•° | ? |
| ä¸ç¬¦åˆé¡¹æ€»æ•° | ? |
| åˆè§„ç‡ | ?% |

### ä¸ç¬¦åˆé¡¹åˆ†ç±»

| ç±»å‹ | ä¸¥é‡ç¨‹åº¦ | æ•°é‡ |
|------|----------|------|
| A: ç¼ºå¤±çš„æµ‹è¯•æ–‡ä»¶ | Critical | ? |
| B: ç¼ºå¤±çš„åœºæ™¯æµ‹è¯• | High | ? |
| C: æµ‹è¯•å‘½åä¸è§„èŒƒ | Medium | ? |
| D: GIVEN-WHEN-THEN ä¸å®Œæ•´ | Medium | ? |
| E: æ–­è¨€ä¸å……åˆ† | Low | ? |

---

## è¯¦ç»†éªŒè¯ç»“æœ

### Domain Layer (5 ä¸ªè§„æ ¼)

#### âœ… domain/pool/model.md
- **æµ‹è¯•æ–‡ä»¶**: `rust/tests/sp_spm_001_spec.rs`
- **çŠ¶æ€**: éƒ¨åˆ†ç¬¦åˆ
- **ä¸ç¬¦åˆé¡¹**:
  - [B-High] ç¼ºå¤±åœºæ™¯: "Device leaves pool and clears data"
  - [E-Low] æ–­è¨€ä¸å……åˆ†: "Create card auto-joins the pool" åœºæ™¯æœªéªŒè¯åŒæ­¥å¼€å§‹

#### âŒ domain/card/model.md
- **æµ‹è¯•æ–‡ä»¶**: æœªæ‰¾åˆ°
- **çŠ¶æ€**: ä¸ç¬¦åˆ
- **ä¸ç¬¦åˆé¡¹**:
  - [A-Critical] ç¼ºå¤±æµ‹è¯•æ–‡ä»¶

#### ...

### Architecture Layer (15 ä¸ªè§„æ ¼)

#### âœ… architecture/sync/service.md
- **æµ‹è¯•æ–‡ä»¶**: `rust/tests/sp_sync_006_spec.rs`
- **çŠ¶æ€**: ç¬¦åˆ
- **ä¸ç¬¦åˆé¡¹**: æ— 

#### ...

### Features Layer (5 ä¸ªè§„æ ¼)

#### ...

### UI Layer (32 ä¸ªè§„æ ¼)

#### ...

---

## æ”¹è¿›å»ºè®®ä¼˜å…ˆçº§åˆ—è¡¨

### Critical (å¿…é¡»ç«‹å³ä¿®å¤)

1. **[A-Critical] åˆ›å»ºç¼ºå¤±çš„æµ‹è¯•æ–‡ä»¶**
   - `domain/card/model.md` â†’ åˆ›å»º `rust/tests/card_model_test.rs`
   - `domain/card/rules.md` â†’ åˆ›å»º `rust/tests/card_rules_test.rs`
   - ...

### High (åº”å°½å¿«ä¿®å¤)

2. **[B-High] è¡¥å……ç¼ºå¤±çš„åœºæ™¯æµ‹è¯•**
   - `domain/pool/model.md` â†’ æ·»åŠ  "Device leaves pool and clears data" æµ‹è¯•
   - ...

### Medium (å»ºè®®ä¿®å¤)

3. **[C-Medium] è§„èŒƒåŒ–æµ‹è¯•å‘½å**
   - `test_join_pool()` â†’ `it_should_allow_joining_first_pool_successfully()`
   - ...

4. **[D-Medium] è¡¥å…… GIVEN-WHEN-THEN æ³¨é‡Š**
   - ...

### Low (å¯é€‰ä¿®å¤)

5. **[E-Low] å¢å¼ºæ–­è¨€è¦†ç›–**
   - ...

---

## é™„å½•

### A. éªŒè¯æ–¹æ³•è¯´æ˜

æœ¬æŠ¥å‘Šä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è¿›è¡ŒéªŒè¯ï¼š
1. è§„æ ¼-æµ‹è¯•æ˜ å°„åˆ†æ
2. åœºæ™¯è¦†ç›–åº¦éªŒè¯
3. æµ‹è¯•å®ç°è´¨é‡æ£€æŸ¥
4. æŠ¥å‘Šç”Ÿæˆ

è¯¦ç»†æ–¹æ³•è¯·å‚è§ `docs/plans/2026-02-01-spec-test-validation-plan.md`ã€‚

### B. è§„æ ¼-æµ‹è¯•æ˜ å°„è¡¨

| è§„æ ¼æ–‡ä»¶ | æµ‹è¯•æ–‡ä»¶ | çŠ¶æ€ |
|---------|---------|------|
| domain/pool/model.md | rust/tests/sp_spm_001_spec.rs | âœ… |
| domain/card/model.md | - | âŒ |
| ... | ... | ... |

### C. æµ‹è¯•å‘½åè§„èŒƒ

**æ¨èå‘½å**: `it_should_<behavior>_when_<condition>()`

**ç¤ºä¾‹**:
- âœ… `it_should_allow_joining_first_pool_successfully()`
- âœ… `it_should_reject_joining_second_pool_when_already_joined()`
- âŒ `test_join_pool()`
- âŒ `test_device_can_join_pool()`

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: YYYY-MM-DD HH:MM:SS
**ç”Ÿæˆå·¥å…·**: CardMind Spec-Test Validator
```

---

## éªŒæ”¶æ ‡å‡†

### å¿…é¡»æ»¡è¶³çš„æ¡ä»¶

- âœ… æ‰€æœ‰ 67 ä¸ªè§„æ ¼æ–‡æ¡£éƒ½å·²éªŒè¯
- âœ… ç”Ÿæˆå®Œæ•´çš„ Markdown æŠ¥å‘Š
- âœ… æ¯ä¸ªä¸ç¬¦åˆé¡¹éƒ½æœ‰è¯¦ç»†è¯´æ˜å’Œæ”¹è¿›å»ºè®®
- âœ… æŠ¥å‘ŠåŒ…å«ç»Ÿè®¡æ‘˜è¦å’Œåˆè§„ç‡
- âœ… æŠ¥å‘Šä¿å­˜åˆ° `docs/reports/spec-test-validation-report.md`
- âœ… ä¸ç¬¦åˆé¡¹æŒ‰ä¸¥é‡ç¨‹åº¦åˆ†ç±»
- âœ… æ”¹è¿›å»ºè®®æŒ‰ä¼˜å…ˆçº§æ’åº

### è´¨é‡æ ‡å‡†

- âœ… æŠ¥å‘Šæ¸…æ™°æ˜“è¯»ï¼Œç»“æ„åˆç†
- âœ… ä¸ç¬¦åˆé¡¹æè¿°å‡†ç¡®ï¼Œæœ‰å…·ä½“ä»£ç ä½ç½®
- âœ… æ”¹è¿›å»ºè®®å¯æ“ä½œï¼Œæœ‰æ˜ç¡®çš„ä¿®å¤æ–¹å‘
- âœ… ç»Ÿè®¡æ•°æ®å‡†ç¡®ï¼Œè®¡ç®—æ–¹æ³•é€æ˜

---

## é£é™©å’Œé™åˆ¶

### å·²çŸ¥é™åˆ¶

1. **è‡ªåŠ¨åŒ–ç¨‹åº¦**: æœ¬æ¬¡éªŒè¯ä¸ºä¸€æ¬¡æ€§æ‰‹åŠ¨éªŒè¯ï¼Œæœªåˆ›å»ºè‡ªåŠ¨åŒ–å·¥å…·
2. **æµ‹è¯•æ‰§è¡Œ**: ä»…éªŒè¯æµ‹è¯•ä»£ç æ˜¯å¦å­˜åœ¨å’Œç»“æ„æ˜¯å¦æ­£ç¡®ï¼Œä¸æ‰§è¡Œæµ‹è¯•
3. **è¯­ä¹‰åˆ†æ**: æ— æ³•æ·±åº¦åˆ†ææµ‹è¯•é€»è¾‘çš„æ­£ç¡®æ€§ï¼Œä»…æ£€æŸ¥ç»“æ„å’Œå‘½å
4. **Flutter æµ‹è¯•**: Flutter Widget æµ‹è¯•çš„éªŒè¯å¯èƒ½ä¸å¦‚ Rust æµ‹è¯•è¯¦ç»†

### æ½œåœ¨é£é™©

1. **è§„æ ¼æ–‡æ¡£ä¸å®Œæ•´**: éƒ¨åˆ†è§„æ ¼å¯èƒ½ç¼ºå°‘ `Related Tests` å­—æ®µ
2. **æµ‹è¯•æ–‡ä»¶å‘½åä¸ä¸€è‡´**: å¯èƒ½å­˜åœ¨æœªæŒ‰çº¦å®šå‘½åçš„æµ‹è¯•æ–‡ä»¶
3. **æ—¶é—´ä¼°ç®—**: å®é™…æ‰§è¡Œæ—¶é—´å¯èƒ½è¶…è¿‡é¢„ä¼°ï¼ˆæ€»è®¡çº¦ 4.5 å°æ—¶ï¼‰

---

## åç»­è¡ŒåŠ¨

### ç«‹å³è¡ŒåŠ¨

1. **æ‰§è¡ŒéªŒè¯**: ä½¿ç”¨ Superpowers ExecutePlan æ‰§è¡Œæœ¬è®¡åˆ’
2. **ç”ŸæˆæŠ¥å‘Š**: å®ŒæˆéªŒè¯åç”Ÿæˆ Markdown æŠ¥å‘Š
3. **å®¡æŸ¥æŠ¥å‘Š**: ä¸å›¢é˜Ÿä¸€èµ·å®¡æŸ¥éªŒè¯ç»“æœ

### çŸ­æœŸè¡ŒåŠ¨ï¼ˆ1-2 å‘¨ï¼‰

1. **ä¿®å¤ Critical é—®é¢˜**: åˆ›å»ºç¼ºå¤±çš„æµ‹è¯•æ–‡ä»¶
2. **ä¿®å¤ High é—®é¢˜**: è¡¥å……ç¼ºå¤±çš„åœºæ™¯æµ‹è¯•
3. **è§„èŒƒåŒ–å‘½å**: ç»Ÿä¸€æµ‹è¯•å‘½åé£æ ¼

### é•¿æœŸè¡ŒåŠ¨ï¼ˆ1-3 ä¸ªæœˆï¼‰

1. **åˆ›å»ºè‡ªåŠ¨åŒ–å·¥å…·**: å°†éªŒè¯æµç¨‹è‡ªåŠ¨åŒ–ï¼Œé›†æˆåˆ° CI/CD
2. **æŒç»­ç›‘æ§**: å®šæœŸè¿è¡ŒéªŒè¯ï¼Œç¡®ä¿è§„æ ¼-æµ‹è¯•ä¸€è‡´æ€§
3. **å®Œå–„è§„æ ¼**: è¡¥å……ç¼ºå¤±çš„è§„æ ¼æ–‡æ¡£

---

## å‚è€ƒæ–‡æ¡£

- [Spec Coding æŒ‡å—](../../openspec/specs/engineering/guide.md)
- [æµ‹è¯•æŒ‡å—](../testing/TESTING_GUIDE.md)
- [CLAUDE.md](../../CLAUDE.md)
- [AGENTS.md](../../AGENTS.md)

---

**æœ€åæ›´æ–°**: 2026-02-01
**ç»´æŠ¤è€…**: CardMind Team
**çŠ¶æ€**: å¾…æ‰§è¡Œ
