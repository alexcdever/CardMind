# CardMind 需求文档

## 1. 概述

CardMind是一个现代化的笔记卡片管理应用，支持多设备间数据同步和离线使用。

## 2. 核心功能

### 2.1 卡片管理
- **创建、编辑、查看和删除卡片**
  - 卡片包含：标题（最多20字符）、内容（最多2000字符）、创建时间和修改时间
  - 创建时间精度：毫秒级
  - 修改时间精度：毫秒级

- **卡片排序与显示**
  - 排序规则：按修改时间倒序，相同时间按标题字母顺序排序
  - 卡片数量：无限制
  - 空列表提示：当卡片列表为空时显示友好提示

- **删除与撤销**
  - 删除确认：需要二次确认，删除后无法撤销

- **数据同步**
  - 数据合并：使用yjs的CRDT算法实现无冲突数据合并

### 2.2 多设备间数据流转
- **同步机制**
  - 支持在多个设备间同步卡片数据
  - 支持离线使用，数据本地存储
  - 无需后端服务器配合

### 2.3 基本安全保护
- 本地数据加密存储
- 防止未授权访问

### 2.4 用户身份认证与协作网络管理

#### 2.4.1 网络ID与设备ID
- **网络ID机制**
  - 基于网络ID的认证机制
  - 每个设备均可生成唯一网络ID
  - 网络ID是协作网络的核心标识

- **设备ID机制**
  - 每个设备生成并存储唯一的设备ID
  - 用于在协作网络中区分不同设备
  - 支持为设备设置友好的设备昵称

#### 2.4.2 Access Code机制
- **Access Code定义**
  - 设备通过输入Access Code加入已存在的协作网络
  - Access Code是包含网络ID和连接信息的加入凭证
  - 同一网络ID下的所有设备共享相同的卡片数据

- **Access Code组成**
  - 网络ID：标识目标协作网络
  - WebRTC连接信息：包含所有设备IP地址列表和信令服务器端口
  - 时间戳：用于连接有效性验证
  - 设备标识：生成该Access Code的设备信息

- **Access Code生成与使用**
  - 生成时机：创建新网络时实时生成、在设置页面中可手动实时生成
  - 存储方式：不持久化存储，每次需要时重新生成
  - 使用方式：通过复制粘贴方式分享

#### 2.4.3 网络原则
- 遵循离线优先原则，无需依赖后端服务器
- 无需第三方授权，简化用户交互流程
- 适用于家庭局域网协同组网场景

### 2.5 用户界面与交互需求

#### 2.5.1 主页布局
- 应用默认显示主页界面，分为底部导航栏和内容区域
- 内容区域默认显示卡片列表

#### 2.5.2 网络认证界面
- 应用首次启动时显示网络加入页面（通过Access Code加入）
- 提供跳过选项，允许用户暂时不加入任何网络

#### 2.5.3 网络设置界面
- 显示网络连接状态和当前网络ID
- 显示在线设备列表，包括设备ID、设备昵称、设备类型
- 提供"生成Access Code"按钮

#### 2.5.4 卡片列表（查）
- 按修改时间排序，最新的卡片显示在最上方
- 每张卡片显示：部分标题、部分内容、创建时间和修改时间

#### 2.5.5 卡片详情（查）
- 点击卡片列表中的任一卡片后弹起详情窗口
- 窗口显示：完整标题、完整内容、创建时间和修改时间

#### 2.5.6 添加卡片（增）
- 主页内容区底部有浮空按钮用于添加新卡片
- 点击后弹出编辑窗口，可输入卡片标题和内容
- 实时显示标题字数统计和内容字数统计

#### 2.5.7 删除卡片（删）
- 在卡片列表中左滑或长按出现删除按钮
- 点击删除按钮后显示二次确认弹窗

#### 2.5.8 修改卡片（改）
- 点击修改按钮后弹出编辑窗口，默认填充当前卡片的标题和内容

## 3. 注意事项

### 3.1 数据安全与隐私
- 所有数据默认在本地加密存储，不上传到第三方服务器
- Access Code包含敏感连接信息，不应通过不安全的渠道分享

### 3.2 网络连接限制
- 设备间直连同步需要在同一局域网环境下
- 不同网络环境下的设备无法直接同步数据

### 3.3 功能限制
- 暂不支持撤销删除操作
- 暂不支持数据导出/导入功能
- 卡片内容有字数限制