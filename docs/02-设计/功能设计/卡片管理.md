# 卡片管理

## 1. 概述

卡片管理是CardMind应用的核心功能，负责卡片的创建、编辑、查看、删除等操作，支持多设备间的数据同步。

## 2. 数据定义

### 2.1 卡片属性

| 属性名 | 类型 | 描述 |
|--------|------|------|
| id | UUID v7 | 卡片的唯一标识符 |
| 标题 | 字符串 | 卡片标题 |
| 内容 | 字符串 | 卡片内容 |
| 创建时间 | 时间戳 | 卡片创建时间 |
| 更新时间 | 时间戳 | 卡片最后修改时间 |

### 2.2 数据关联
- 一个卡片对应一个LoroDoc对象，LoroDoc的唯一id即为卡片id

## 3. 功能设计

### 3.1 卡片创建
- **触发时机**：用户点击悬浮添加按钮
- **功能描述**：允许用户创建新的卡片
- **网络行为**：
  - 未设置常驻网络时，新建卡片默认不加入任何协作网络
  - 支持自由加入/退出任意协作网络

### 3.2 卡片编辑
- **触发时机**：用户在卡片列表中选择编辑操作
- **功能描述**：允许用户修改已创建的卡片

### 3.3 卡片查看
- **卡片列表**：显示所有卡片，按修改时间倒序排序
- **卡片详情**：显示完整的卡片内容

### 3.4 卡片删除
- **触发时机**：用户在卡片列表中选择删除操作
- **功能描述**：允许用户删除已创建的卡片

## 4. 常驻网络规则
- 设置后新建的卡片会自动加入所有常驻网络

## 5. 存储设计
- **存储方案**：使用SQLite数据库，参考卡片和协作网络属性建表
- **数据结构**：额外添加字段存储LoroDoc二进制数据
- **设计目标**：SQLite表主要用于保存最新数据，提供快速查询能力

## 6. 数据处理流程
- **写操作**：Flutter传入写数据请求 → Rust端写入Loro → 通过Loro的subscribe机制自动更新SQLite表数据
- **读操作**：Flutter直接从SQLite表中读取数据
- **设计目标**：实现后端数据的读写分离，提高系统性能和响应速度
